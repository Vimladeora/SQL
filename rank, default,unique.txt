use sakila;
select * from actor;

select * from payment;

select payment_id ,customer_id, amount,
 rank() 
  over (partition by customer_id order by amount desc)
as rank1,
dense_rank()
over(partition by customer_id order by amount desc)  
 as drank1 from payment;

select * from 
(select payment_id, customer_id,amount,
dense_rank()
	over(order by amount desc) as drank1
from sakila.payment) as tab where drank1=3;    

-- how to insert and update data 
 create table xyz( id int , fname varchar(20));
 insert into xyz values(10,'ram');
 insert into xyz values(11);
 insert into xyz (id) value(10);
 select * from xyz;
 
 update xyz set  fname ='regex';
 update xyz set fname =  'tushar' where id=10;
 select * from xyz;
 
 delete from xyz where id = 11;
  -- dml => insert , update, delete
  
  drop table xyz;
  
use sakila ;
create table xyz1( id int not null, fname varchar(20));
insert into xyz1 values(1,'tushar');
select * from xyz1;
  
create table xyz2( id int not null, fname varchar(20) unique);
insert into xyz2 values(1,'tushar2');
insert into xyz2 values(2,'tushar3');
insert into xyz2 values(2, null);

select * from xyz2;

create table xyz3( id int ,fname varchar(20) default 'regex');
insert into xyz3 values(1,'tushar2');
insert into xyz3 (id) values(2);
select * from xyz3;

create table xyz4( dob datetime default now());
insert into xyz4 values('2024-10-09');
insert into xyz4() values();
select * from xyz4;

create table xyz5( id int primary key );
insert into xyz5 values(1);
insert into xyz5() values(null);
select * from xyz5;

create table admission(id int, clg_name varchar(20), student_id int);
insert into admission values (1 , 'MMV', 100);
insert into admission values (2, 'JEET', 101); 
insert into admission values(3, 'oxford', 102);
drop table student;

create table  student(student_id int primary key, student_name varchar(20));
insert into student values (1,'Deora');
insert into student values (2,'sharma');

select * from admission;

drop table admission;

CREATE TABLE admission (
  admission_id int primary key,
  clg_name varchar(20),
  student_id int,
  foreign key (student_id) references student(student_id)
);

desc admission;

create table students (student_id int primary key, name varchar(20), age int, grade int, city varchar(20));

create table marks(student_id int, subjects varchar(20),marks int, foreign key(student_id) references students(student_id));

use sakila;

create table test99 as 
	 select actor_id, first_name from actor;
     
 select * from test99;   
 
 -- delete actor id whose actorid is same as that of first name of customer id is phinilope
  delete from actor where actor_id in (select actor_id where first_name = 'Phinilope'); 

-- update the amt done by customer_id 1 as with the same amount done by the customer for payment id 2
drop table test98;
create table test98 as select customer_id, amount,payment_id from payment; 
select * from test98;
update test98 set amount = (select amount from payment where payment_id = 2) where customer_id = 1; 